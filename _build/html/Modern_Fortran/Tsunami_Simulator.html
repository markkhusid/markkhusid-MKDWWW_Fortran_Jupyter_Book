
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tsunami Simulator &#8212; Fortran Programming</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=d5fdc4d5" />
    <link rel="stylesheet" type="text/css" href="../_static/.ipynb_checkpoints/style-checkpoint.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Modern_Fortran/Tsunami_Simulator';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tsunami Simulator Plotter" href="Tsunami_Simulator_Plotter.html" />
    <link rel="prev" title="Cold Front Calculator With Loop" href="Cold_Front_Calculator_with_Loop.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/fortran_code_integrate.jpeg" class="logo__image only-light" alt="Fortran Programming - Home"/>
    <script>document.write(`<img src="../_static/fortran_code_integrate.jpeg" class="logo__image only-dark" alt="Fortran Programming - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Fortran Programming
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Modern Fortran</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Modern_Fortran.html">Modern Fortran</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Cold_Front_Calculator.html">Cold Front Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="Cold_Front_Calculator_with_Loop.html">Cold Front Calculator With Loop</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tsunami Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tsunami_Simulator_Plotter.html">Tsunami Simulator Plotter</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tsunami_Simulator_with_Modules.html">Tsunami Simulator with Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tsunami_Simulator_with_Modules_Plotter.html">Tsunami Simulator with Modules Plotter</a></li>
<li class="toctree-l2"><a class="reference internal" href="Print_Compiler_Version.html">Print Compiler Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Analyzing_Time_Series_Data_with_Arrays.html">Analyzing Time Series Data with Arrays</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Programming Using Fortran</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Introduction_to_Programming_Using_Fortran/Introduction_to_Programming_Using_Fortran.html">Introduction to Programming Using Fortran</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Introduction_to_Programming_Using_Fortran/Section_7_Period_Calculator.html">Section 7: Pendulum Period Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction_to_Programming_Using_Fortran/Section_9_3_SOS_Difference.html">Section 9.3: Difference Between Sum of Squares and Square of Sums</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction_to_Programming_Using_Fortran/Section_12_8_Line_Numbers.html">Section 12.8: Line Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Introduction_to_Programming_Using_Fortran/Section_14_Pi_Estimation.html">Section 14: Pi Estimation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Guide to Fortran 2008 Programming</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Guide_to_Fortran_2008_Programming.html">Guide to Fortran 2008 Programming</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_1_8_Ex_2_Quadratic_Formula.html">Section 1.8 Example 2: Quadratic Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_1_16_Factorial_Recursion.html">Section 1.16: Factorial Recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_2_1_Associate_Construct.html">Section 2.1: Statement Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_2_1_Statement_Blocks.html">Section 2.1: Associate Construct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_4_Putting_Procedures_in_a_Module.html">Section 3.4: Putting Procedures in a Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_6_Ex_1_Median_of_Three.html">Section 3.6: Median of Three</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_8_Argument_Passing.html">Section 3.8: Argument Passing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_17_Case_Study__Adaptive_Numberical_Integration.html">Section 3.17: Case Study: Adaptive Numerical Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_4_1_Elsewhere_Example.html">Section 4.1: Elsewhere Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_1_Submodules.html">Section 8.1: Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_2_Time_Matrix_Multiply.html">Section 8.2: Time Matrix Multiply</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_7_Generic_Elemental_Procedures.html">Section 8.7: Generic Elemental Procedures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_8_Findloc_Function.html">Section 8.8: Findloc Function</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fortran MOOC</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Fortran_MOOC/Fortran_MOOC.html">Fortran MOOC</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays.html">Section: Arrays</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Allocate_from_Source.html">Section Arrays: Allocate from Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Array_Arithmetic.html">Section Arrays: Array Arithmetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Array_Elements.html">Section Arrays: Array Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Array_Initialization.html">Section Arrays: Array Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Array_Timing.html">Section Arrays: Array Timing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Assumed.html">Section Arrays: Assumed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Compute_Factorial.html">Section Arrays: Compute Factorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Elemental_Subroutine.html">Section Arrays: Elemental Subroutine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Enlarge_Array.html">Section Arrays: Enlarge Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Identity.html">Section Arrays: Identity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Linear_Transform.html">Section Arrays: Linear Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Matrix.html">Section Arrays: Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Max_Array.html">Section Arrays: Max Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Normalize.html">Section Arrays: Normalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Normalize_Performance.html">Section Arrays: Normalize Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Reshape.html">Section Arrays: Reshape</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Subarrays.html">Section Arrays: Subarrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Submatrices.html">Section Arrays: Submatrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays_Trace.html">Section Arrays: Trace</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Fortran_MOOC/Section_Floating_Point.html">Section: Floating Point</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_IEEE754_16_Zero_vs_Non_Zero.html">Section IEEE754: Zero vs Non - Zero</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Fortran_MOOC/Section_Call_By_Semantics.html">Section: Call By Semantics</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Call_By_Semantics_Call_By_In_Reference.html">Section Call By Semantics: Call By In Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Call_By_Semantics_Call_By_Reference.html">Section Call By Semantics: Call By Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Call_By_Semantics_Call_By_Value.html">Section Call By Semantics: Call By Value</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Fortran_MOOC/Section_Computing_Pi.html">Section: Computing Pi</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Computing_Pi_Compute_Pi.html">Section Computing Pi: Compute Pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Computing_Pi_Compute_Pi_OpenMP.html">Section Computing Pi: Compute Pi with OpenMP</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Fortran_MOOC/Section_Implicit_vs_Explicit_Loops__Head__.html">Section: Implicit vs Explicit Loops</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Implicit_vs_Explicit_Loops.html">Section: Implicit vs. Explicit Loops</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Fortran_MOOC/Section_Block_Matrices__Head__.html">Section: Block Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Fortran_MOOC/Section_Block_Matrices.html">Section: Block Matrices</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK__Head__.html">Section: BLAS/LAPACK</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_BLAS95__Head__.html">Section: BLAS/LAPACK - BLAS95</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_BLAS95.html">Section: BLAS/LAPACK - BLAS95</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_Linear_Equations__Head__.html">Section: BLAS/LAPACK - Linear Equations</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_Linear_Equations.html">Section: BLAS/LAPACK - Linear Equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_Dot.html">Section: BLAS/LAPACK - Dot Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_Copy.html">Section: BLAS/LAPACK - Vector Copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_DDOT_Timing.html">Section: BLAS/LAPACK - DDOT Timing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_GEMV.html">Section: BLAS/LAPACK - GEMV</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_Scal.html">Section: BLAS/LAPACK - SCAL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK_SV.html">Section: BLAS/LAPACK - SV</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Content with notebooks</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/markkhusid/markkhusid-MKDWWW_Fortran_Jupyter_Book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Modern_Fortran/Tsunami_Simulator.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tsunami Simulator</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-advection-equation">The Advection Equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-to-predict-the-linear-advection-of-an-object-with-periodic-boundary-conditions">Program to Predict the Linear Advection of an Object, with Periodic Boundary Conditions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-explanation">Program Explanation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-elements-of-the-program">Key Elements of the Program</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#program-execution-details">Program Execution Details</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-applications">Practical Applications</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-compilation-and-execution">Program Compilation and Execution</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tsunami-simulator">
<h1>Tsunami Simulator<a class="headerlink" href="#tsunami-simulator" title="Link to this heading">#</a></h1>
<p>The following program simulates a tsunami water wave. <br>
Adapted from: “<a class="reference external" href="https://www.manning.com/books/modern-fortran">Modern Fortran: Building Efficient Parallel Applications</a>” by Milan Curcic (Manning)</p>
<p>The tsunami water wave height and speed will be calculated using the advection equation.</p>
<p>From <a class="reference external" href="https://en.wikipedia.org/wiki/Advection">wikipedia</a>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the field of physics, engineering, and earth sciences, advection is the transport of a substance or quantity by bulk motion of a fluid.</p>
</div>
<section id="the-advection-equation">
<h2>The Advection Equation<a class="headerlink" href="#the-advection-equation" title="Link to this heading">#</a></h2>
<div class="math notranslate nohighlight">
\[
\Large \frac{\delta u}{\delta t} + c\frac{\delta u}{\delta x} = 0
\]</div>
</section>
<section id="program-to-predict-the-linear-advection-of-an-object-with-periodic-boundary-conditions">
<h2>Program to Predict the Linear Advection of an Object, with Periodic Boundary Conditions<a class="headerlink" href="#program-to-predict-the-linear-advection-of-an-object-with-periodic-boundary-conditions" title="Link to this heading">#</a></h2>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">tsunami</span>

<span class="w">    </span><span class="k">implicit none</span>
<span class="k">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">    </span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grid_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_time_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>

<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c">! time step [s]</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c">! grid spacing [m]</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">c</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c">! phase speed [m/s]</span>

<span class="w">    </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="n">grid_size</span><span class="p">),</span><span class="w"> </span><span class="n">dh</span><span class="p">(</span><span class="n">grid_size</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icenter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span>
<span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.02</span>
<span class="w">    </span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">file_exists</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">open</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tsunami_simulator_data.txt&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">grid_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;grid_size must be &gt; 0&#39;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;time step dt must be &gt; 0&#39;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;grid spacing dx must be &gt; 0&#39;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;background flow speed c must be &gt; 0&#39;</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">do</span><span class="w"> </span><span class="k">concurrent</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">grid_size</span><span class="p">)</span>
<span class="w">        </span><span class="n">h</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">decay</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">icenter</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>
<span class="w">    </span>
<span class="w">    </span><span class="c">!print *, 0, h</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">h</span>
<span class="w">    </span><span class="k">close</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">time_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">num_time_steps</span><span class="w">    </span>
<span class="w">        </span>
<span class="w">        </span><span class="n">dh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="n">grid_size</span><span class="p">)</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">do</span><span class="w"> </span><span class="k">concurrent</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="n">grid_size</span><span class="p">)</span>
<span class="w">            </span><span class="n">dh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">       </span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        </span>
<span class="k">        do</span><span class="w"> </span><span class="k">concurrent</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">grid_size</span><span class="p">)</span>
<span class="w">            </span><span class="n">h</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">h</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">dh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span>
<span class="w">        </span><span class="k">end do</span>
<span class="w">        </span>
<span class="w">        </span><span class="c">!print *, n, h</span>
<span class="w">        </span><span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tsunami_simulator_data.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">exist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file_exists</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file_exists</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            open</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tsunami_simulator_data.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;old&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;append&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">            open</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tsunami_simulator_data.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;new&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        </span>
<span class="k">        write</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">h</span>

<span class="w">    </span><span class="k">end do </span><span class="n">time_loop</span>

<span class="w">    </span><span class="k">close</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="w">    </span>
<span class="k">end program </span><span class="n">tsunami</span>
</pre></div>
</div>
</section>
<section id="program-explanation">
<h2>Program Explanation<a class="headerlink" href="#program-explanation" title="Link to this heading">#</a></h2>
<p>The Fortran program <code class="docutils literal notranslate"><span class="pre">tsunami</span></code> simulates the propagation of a wave in a one-dimensional grid using a basic numerical scheme akin to the finite difference method. The purpose of the program is to approximate how a disturbance, initialized in the middle of the domain, evolves over time given the specified parameters.</p>
<section id="key-elements-of-the-program">
<h3>Key Elements of the Program<a class="headerlink" href="#key-elements-of-the-program" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Variable Declarations and Constants</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">grid_size</span></code>: The number of grid points in the simulation domain.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_time_steps</span></code>: The number of time steps for which the simulation will run.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code>: Time step in seconds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code>: Spatial grid spacing in meters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code>: Phase speed of the wave in meters per second.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">h</span></code>: Height of the wave at each grid point.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dh</span></code>: Temporal change in height at each grid point between consecutive steps.</p></li>
</ul>
</li>
<li><p><strong>Initialization</strong>:</p>
<ul class="simple">
<li><p>An initial wave profile is set using a Gaussian-like exponential decay formula centered at <code class="docutils literal notranslate"><span class="pre">icenter</span></code>, influencing how sharply the wave amplitude decreases away from the center.</p></li>
</ul>
</li>
<li><p><strong>File Handling</strong>:</p>
<ul class="simple">
<li><p>The program opens a file named ‘tsunami_simulator_data.txt’ for output and checks for its existence before each write operation to handle potential errors or file state changes during execution.</p></li>
</ul>
</li>
<li><p><strong>Numerical Scheme</strong>:</p>
<ul class="simple">
<li><p>The simulation uses a simple difference scheme to approximate the temporal evolution of the wave:</p>
<ul>
<li><p><strong>Boundary Condition</strong>: A cyclic boundary condition is assumed (<code class="docutils literal notranslate"><span class="pre">dh(1)</span> <span class="pre">=</span> <span class="pre">h(1)</span> <span class="pre">-</span> <span class="pre">h(grid_size)</span></code>), which allows the wave to wrap around the domain, simulating an infinite or periodic space.</p></li>
<li><p><strong>Interior Points</strong>: The change in height (<code class="docutils literal notranslate"><span class="pre">dh</span></code>) at each internal grid point is computed based on the difference with its immediate left neighbor.</p></li>
<li><p><strong>Update Step</strong>: The wave height at each grid point is updated using the computed differences, scaled by the wave speed, grid spacing, and time step.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Looping Structure</strong>:</p>
<ul class="simple">
<li><p>The main loop (<code class="docutils literal notranslate"><span class="pre">time_loop</span></code>) iterates over the number of time steps, updating the wave’s profile at each step and writing the results to the output file.</p></li>
<li><p>An <code class="docutils literal notranslate"><span class="pre">inquire</span></code> statement checks if the output file still exists before attempting to append new data, which helps in managing output data integrity.</p></li>
</ul>
</li>
<li><p><strong>Output</strong>:</p>
<ul class="simple">
<li><p>For each time step, the wave heights across the grid are written to the file. This output can be used for further analysis or visualization of the wave’s propagation.</p></li>
</ul>
</li>
</ol>
</section>
<section id="program-execution-details">
<h3>Program Execution Details<a class="headerlink" href="#program-execution-details" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Initialization of <code class="docutils literal notranslate"><span class="pre">h</span></code></strong>:</p>
<ul>
<li><p>The wave height at each grid point is initialized to create a localized disturbance. The exponential decay formula makes the initial wave amplitude highest at the center and decreases moving away from the center.</p></li>
</ul>
</li>
<li><p><strong>Time Evolution</strong>:</p>
<ul>
<li><p>At each time step, the program computes the spatial gradient of the wave heights, then adjusts the heights based on this gradient, effectively simulating the wave propagation.</p></li>
</ul>
</li>
<li><p><strong>File Operations</strong>:</p>
<ul>
<li><p>Before writing to the file, the program ensures it’s in the correct state (open and ready for appending), handling the possibility that the file might not be available or already open from previous operations.</p></li>
</ul>
</li>
</ul>
</section>
<section id="practical-applications">
<h3>Practical Applications<a class="headerlink" href="#practical-applications" title="Link to this heading">#</a></h3>
<p>This program is a simplistic representation useful for educational purposes in teaching numerical methods for solving partial differential equations, specifically hyperbolic equations like the wave equation. It can also serve as a basic model in physical sciences and engineering for understanding wave dynamics in a controlled setting.</p>
</section>
</section>
<section id="program-compilation-and-execution">
<h2>Program Compilation and Execution<a class="headerlink" href="#program-compilation-and-execution" title="Link to this heading">#</a></h2>
<p>The above program is compiled and run using Fortran Package Manager (fpm):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">root_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">code_dir</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="s2">&quot;Fortran_Code/Tsunami_Simulator&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">code_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_status</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;fpm build 2&gt;/dev/null&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exec_status</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;fpm run 2&gt;/dev/null&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The above Fortran code writes the calculations to a file called <strong>tsunami_simulator_data.txt</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">output_filename</span> <span class="o">=</span> <span class="s1">&#39;tsunami_simulator_data.txt&#39;</span>
<span class="n">data_file</span> <span class="o">=</span> <span class="n">code_dir</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">output_filename</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
      <th>100</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>9.929509e-06</td>
      <td>0.000025</td>
      <td>0.000063</td>
      <td>0.000148</td>
      <td>0.000335</td>
      <td>0.000732</td>
      <td>0.001534</td>
      <td>0.003089</td>
      <td>0.005976</td>
      <td>...</td>
      <td>1.459711e-38</td>
      <td>1.021038e-39</td>
      <td>6.862018e-41</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0.000000e+00</td>
      <td>0.000010</td>
      <td>0.000025</td>
      <td>0.000063</td>
      <td>0.000148</td>
      <td>0.000335</td>
      <td>0.000732</td>
      <td>0.001534</td>
      <td>0.003089</td>
      <td>...</td>
      <td>2.005009e-37</td>
      <td>1.459711e-38</td>
      <td>1.021038e-39</td>
      <td>6.862018e-41</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000010</td>
      <td>0.000025</td>
      <td>0.000063</td>
      <td>0.000148</td>
      <td>0.000335</td>
      <td>0.000732</td>
      <td>0.001534</td>
      <td>...</td>
      <td>2.646043e-36</td>
      <td>2.005009e-37</td>
      <td>1.459711e-38</td>
      <td>1.021038e-39</td>
      <td>6.862018e-41</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000010</td>
      <td>0.000025</td>
      <td>0.000063</td>
      <td>0.000148</td>
      <td>0.000335</td>
      <td>0.000732</td>
      <td>...</td>
      <td>3.355098e-35</td>
      <td>2.646043e-36</td>
      <td>2.005009e-37</td>
      <td>1.459711e-38</td>
      <td>1.021038e-39</td>
      <td>6.862018e-41</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>1.401298e-45</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000010</td>
      <td>0.000025</td>
      <td>0.000063</td>
      <td>0.000148</td>
      <td>0.000335</td>
      <td>...</td>
      <td>4.087346e-34</td>
      <td>3.355098e-35</td>
      <td>2.646043e-36</td>
      <td>2.005009e-37</td>
      <td>1.459711e-38</td>
      <td>1.021038e-39</td>
      <td>6.862018e-41</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>96</th>
      <td>96</td>
      <td>3.354626e-04</td>
      <td>0.000732</td>
      <td>0.001534</td>
      <td>0.003089</td>
      <td>0.005976</td>
      <td>0.011109</td>
      <td>0.019841</td>
      <td>0.034047</td>
      <td>0.056135</td>
      <td>...</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>9.929508e-06</td>
      <td>2.541935e-05</td>
      <td>6.252155e-05</td>
      <td>1.477484e-04</td>
    </tr>
    <tr>
      <th>97</th>
      <td>97</td>
      <td>1.477484e-04</td>
      <td>0.000335</td>
      <td>0.000732</td>
      <td>0.001534</td>
      <td>0.003089</td>
      <td>0.005976</td>
      <td>0.011109</td>
      <td>0.019841</td>
      <td>0.034047</td>
      <td>...</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>9.929508e-06</td>
      <td>2.541935e-05</td>
      <td>6.252155e-05</td>
    </tr>
    <tr>
      <th>98</th>
      <td>98</td>
      <td>6.252155e-05</td>
      <td>0.000148</td>
      <td>0.000335</td>
      <td>0.000732</td>
      <td>0.001534</td>
      <td>0.003089</td>
      <td>0.005976</td>
      <td>0.011109</td>
      <td>0.019841</td>
      <td>...</td>
      <td>6.862018e-41</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>9.929508e-06</td>
      <td>2.541935e-05</td>
    </tr>
    <tr>
      <th>99</th>
      <td>99</td>
      <td>2.541935e-05</td>
      <td>0.000063</td>
      <td>0.000148</td>
      <td>0.000335</td>
      <td>0.000732</td>
      <td>0.001534</td>
      <td>0.003089</td>
      <td>0.005976</td>
      <td>0.011109</td>
      <td>...</td>
      <td>1.021038e-39</td>
      <td>6.862018e-41</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>9.929508e-06</td>
    </tr>
    <tr>
      <th>100</th>
      <td>0</td>
      <td>9.929508e-06</td>
      <td>0.000025</td>
      <td>0.000063</td>
      <td>0.000148</td>
      <td>0.000335</td>
      <td>0.000732</td>
      <td>0.001534</td>
      <td>0.003089</td>
      <td>0.005976</td>
      <td>...</td>
      <td>1.459711e-38</td>
      <td>1.021038e-39</td>
      <td>6.862018e-41</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
  </tbody>
</table>
<p>101 rows × 101 columns</p>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Modern_Fortran"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Cold_Front_Calculator_with_Loop.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Cold Front Calculator With Loop</p>
      </div>
    </a>
    <a class="right-next"
       href="Tsunami_Simulator_Plotter.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tsunami Simulator Plotter</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-advection-equation">The Advection Equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-to-predict-the-linear-advection-of-an-object-with-periodic-boundary-conditions">Program to Predict the Linear Advection of an Object, with Periodic Boundary Conditions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-explanation">Program Explanation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-elements-of-the-program">Key Elements of the Program</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#program-execution-details">Program Execution Details</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-applications">Practical Applications</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-compilation-and-execution">Program Compilation and Execution</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mark Khusid
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>